<!DOCTYPE html>
<html style="display: none;" lang="zh">
    <head>
    <meta charset="utf-8">
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.4.0 -->
    <script>window.materialVersion = "1.4.0"</script>

    <!-- Title -->
    
    <title>
        
            Spring-data JPA 注解详解 | 
        
        木子 oto
    </title>

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">
    
    
    
    
    
    
    
    
    
    

    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="theme-color" content="#0097A7">
    <meta name="author" content="sourfeng">
    <meta name="description" itemprop="description" content="在使用spring-data-jpa时，遇到的一些问题，然后查阅资料，对其中的注解部分进行了整理，方便以后使用">
    <meta name="keywords" content="android java,spring-data-jpa">

    <!-- Site Verification -->
    
    

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.png">
    <link rel="icon" sizes="192x192" href="/img/favicon.png">
    <link rel="apple-touch-icon" href="/img/favicon.png">

    <!--iOS -->
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="木子 oto">

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://sourfeng.cn">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="Spring-data JPA 注解详解 | 木子 oto">
    <meta property="og:image" content="/img/favicon.png" />
    <meta property="og:description" content="在使用spring-data-jpa时，遇到的一些问题，然后查阅资料，对其中的注解部分进行了整理，方便以后使用">
    <meta property="og:article:tag" content="spring-data-jpa"> 

    
        <meta property="article:published_time" content="5月 08, 2017" />
        <meta property="article:modified_time" content="5月 08, 2017" />
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:title" content="Spring-data JPA 注解详解 | 木子 oto">
    <meta name="twitter:description" content="在使用spring-data-jpa时，遇到的一些问题，然后查阅资料，对其中的注解部分进行了整理，方便以后使用">
    <meta name="twitter:image" content="/img/favicon.png">
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content="http://sourfeng.cn" />

    <!-- Add canonical link for SEO -->
    
        <link rel="canonical" href="http://sourfeng.cn/2017/05/08/spring-data-jpa/index.html" />
    

    <!-- Structured-data for SEO -->
    
        


<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "木子 oto",
        "logo": "/img/favicon.png"
    },
    "author": {
        "@type": "Person",
        "name": "sourfeng",
        "image": {
            "@type": "ImageObject",
            "url": "/img/favicon.png"
        },
        "description": "Hi, nice to meet you"
    },
    "headline": "Spring-data JPA 注解详解",
    "url": "http://sourfeng.cn/2017/05/08/spring-data-jpa/index.html",
    "datePublished": "5月 08, 2017",
    "dateModified": "5月 08, 2017",
    "description": "在使用spring-data-jpa时，遇到的一些问题，然后查阅资料，对其中的注解部分进行了整理，方便以后使用",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://sourfeng.cn"
    }
}
</script>


    

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import lsloader -->
    <script>(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}};lsloader.removeLS=function(key){try{localStorage.removeItem(key)}catch(e){}};lsloader.setLS=function(key,val){try{localStorage.setItem(key,val)}catch(e){}};lsloader.getLS=function(key){var val="";try{val=localStorage.getItem(key)}catch(e){val=""}return val};versionString="/*"+materialVersion+"*/";lsloader.clean=function(){try{var keys=[];for(var i=0;i<localStorage.length;i++){keys.push(localStorage.key(i))}keys.forEach(function(key){var data=lsloader.getLS(key);if(data&&data.indexOf(versionString)===-1){lsloader.removeLS(key)}})}catch(e){}};lsloader.clean();lsloader.load=function(jsname,jspath,cssonload){cssonload=cssonload||function(){};var code;code=this.getLS(jsname);if(code&&code.indexOf(versionString)===-1){this.removeLS(jsname);this.requestResource(jsname,jspath,cssonload);return}if(code){var versionNumber=code.split(versionString)[0];if(versionNumber!=jspath){console.log("reload:"+jspath);this.removeLS(jsname);this.requestResource(jsname,jspath,cssonload);return}code=code.split(versionString)[1];if(/\.js?.+$/.test(versionNumber)){this.jsRunSequence.push({name:jsname,code:code});this.runjs(jspath,jsname,code)}else{document.getElementById(jsname).appendChild(document.createTextNode(code));cssonload()}}else{this.requestResource(jsname,jspath,cssonload)}};lsloader.requestResource=function(name,path,cssonload){var that=this;if(/\.js?.+$/.test(path)){this.iojs(path,name,function(path,name,code){that.setLS(name,path+versionString+code);that.runjs(path,name,code)})}else if(/\.css?.+$/.test(path)){this.iocss(path,name,function(code){document.getElementById(name).appendChild(document.createTextNode(code));that.setLS(name,path+versionString+code)},cssonload)}};lsloader.iojs=function(path,jsname,callback){var that=this;that.jsRunSequence.push({name:jsname,code:""});try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(path,jsname,xhr.response);return}}that.jsfallback(path,jsname)}};xhr.send(null)}catch(e){that.jsfallback(path,jsname)}};lsloader.iocss=function(path,jsname,callback,cssonload){var that=this;try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(xhr.response);cssonload();return}}that.cssfallback(path,jsname,cssonload)}};xhr.send(null)}catch(e){that.cssfallback(path,jsname,cssonload)}};lsloader.iofonts=function(path,jsname,callback,cssonload){var that=this;try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(xhr.response);cssonload();return}}that.cssfallback(path,jsname,cssonload)}};xhr.send(null)}catch(e){that.cssfallback(path,jsname,cssonload)}};lsloader.runjs=function(path,name,code){if(!!name&&!!code){for(var k in this.jsRunSequence){if(this.jsRunSequence[k].name==name){this.jsRunSequence[k].code=code}}}if(!!this.jsRunSequence[0]&&!!this.jsRunSequence[0].code&&this.jsRunSequence[0].status!="failed"){var script=document.createElement("script");script.appendChild(document.createTextNode(this.jsRunSequence[0].code));script.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(script);this.jsRunSequence.shift();if(this.jsRunSequence.length>0){this.runjs()}}else if(!!this.jsRunSequence[0]&&this.jsRunSequence[0].status=="failed"){var that=this;var script=document.createElement("script");script.src=this.jsRunSequence[0].path;script.type="text/javascript";this.jsRunSequence[0].status="loading";script.onload=function(){that.jsRunSequence.shift();if(that.jsRunSequence.length>0){that.runjs()}};document.body.appendChild(script)}};lsloader.tagLoad=function(path,name){this.jsRunSequence.push({name:name,code:"",path:path,status:"failed"});this.runjs()};lsloader.jsfallback=function(path,name){if(!!this.jsnamemap[name]){return}else{this.jsnamemap[name]=name}for(var k in this.jsRunSequence){if(this.jsRunSequence[k].name==name){this.jsRunSequence[k].code="";this.jsRunSequence[k].status="failed";this.jsRunSequence[k].path=path}}this.runjs()};lsloader.cssfallback=function(path,name,cssonload){if(!!this.cssnamemap[name]){return}else{this.cssnamemap[name]=1}var link=document.createElement("link");link.type="text/css";link.href=path;link.rel="stylesheet";link.onload=link.onerror=cssonload;var root=document.getElementsByTagName("script")[0];root.parentNode.insertBefore(link,root)};lsloader.runInlineScript=function(scriptId,codeId){var code=document.getElementById(codeId).innerText;this.jsRunSequence.push({name:scriptId,code:code});this.runjs()};lsloader.loadCombo=function(jslist){var updateList="";var requestingModules={};for(var k in jslist){var LS=this.getLS(jslist[k].name);if(!!LS){var version=LS.split(versionString)[0];var code=LS.split(versionString)[1]}else{var version=""}if(version==jslist[k].path){this.jsRunSequence.push({name:jslist[k].name,code:code,path:jslist[k].path})}else{this.jsRunSequence.push({name:jslist[k].name,code:null,path:jslist[k].path,status:"comboloading"});requestingModules[jslist[k].name]=true;updateList+=(updateList==""?"":";")+jslist[k].path}}var that=this;if(!!updateList){var xhr=new XMLHttpRequest;xhr.open("get",combo+updateList,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){that.runCombo(xhr.response,requestingModules);return}}else{for(var i in that.jsRunSequence){if(requestingModules[that.jsRunSequence[i].name]){that.jsRunSequence[i].status="failed"}}that.runjs()}}};xhr.send(null)}this.runjs()};lsloader.runCombo=function(comboCode,requestingModules){comboCode=comboCode.split("/*combojs*/");comboCode.shift();for(var k in this.jsRunSequence){if(!!requestingModules[this.jsRunSequence[k].name]&&!!comboCode[0]){this.jsRunSequence[k].status="comboJS";this.jsRunSequence[k].code=comboCode[0];this.setLS(this.jsRunSequence[k].name,this.jsRunSequence[k].path+versionString+comboCode[0]);comboCode.shift()}}this.runjs()}})();</script>

    <!-- Import CSS & jQuery -->
    
        <style id="css/material.min.css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("css/material.min.css","/css/material.min.css?fJTiM/K1J3dWIruo3pxtAw==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";})</script>
        <style id="css/style.min.css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("css/style.min.css","/css/style.min.css?oCSEO3ST+aEypEwttTDI9g==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";})</script>
        
        
            <style>
    
    
    
    
    
    
    
    .footer-sns-github {
        background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgY2xhc3M9Imljb24iIHZpZXdCb3g9IjAgMCAxMDI0IDEwMjQiPjxwYXRoIGQ9Ik0xMzguNCA3OGMtNi40IDEuNC0yNi40IDE0LjItMzYgMjIuOC04IDcuMi0yMiAyOS44LTI0LjQgMzkuMi0xLjYgNi40LTIgMTEzLjItMS42IDM2OCAuNiAyOTkuNCAxIDM1OS44IDMuNCAzNjQgMTEgMjAuMiAyMS42IDMyLjQgMzcuMiA0MyAxNS42IDEwLjYgMTcuMiAxMS4yIDM0LjIgMTMuMiAxMC42IDEuMiA2My40IDEuNiAxMjcuNiAxLjRsMTA5LjYtLjYgNi02LjggNi4yLTYuOC0xLjItMjUuMmMtLjgtMTUuOC0uMi0zMy40IDEuNC00Ny4yIDMtMjUuNCAxLjQtMzYuMi02LTQzLjItNS00LjYtNi4yLTQuOC0zMC42LTQuMi0yNy42LjgtMjQgMS42LTY4LjgtMTYtOC42LTMuNC0yMi42LTE4LTI4LjQtMjkuOC0xMS40LTIyLjgtMjctNDUtMzkuMi01NS42LTE0LTEyLjItMTkuOC0yMC44LTE5LjgtMjguNiAwLTExLjYgMTMuNi0xMi42IDMzLjItMi40IDE2LjYgOC44IDIwLjggMTIuNCA0MC44IDM2LjIgMjQuMiAyOC42IDMxIDMzLjYgNTQgMzkuNiAxNS4yIDQgNDIuMiAzIDUxLjQtMS44IDktNC42IDE4LTE1LjIgMjQuNC0yOS4yIDExLjQtMjQuMiA3LjQtMzEuMi0yMC42LTM2LjgtOS44LTItMjkuMi04LTQzLjQtMTMuNC00MC40LTE1LjgtNjQuNi0zNy40LTg1LjQtNzYuMi0xMS42LTIxLjgtMTUuNC0zMy0xOC4yLTUzLjYtNC4yLTMyLjItNC44LTYwLjItMS40LTg0IDMuNC0yMy44IDYuOC0zMi44IDIwLjItNTQgNC02IDguOC0xNS42IDExLTIxLjQgMy44LTEwIDMuOC0xMS42IDEtMzAtNS4yLTM0LjItMy4yLTUyLjQgNy42LTcwLjIgNy4yLTEyLjIgMTUtMTcuMiAyNC4yLTE1LjggMTIuOCAyLjIgNTIgMTcuNCA2Ni44IDI2LjIgMjYgMTUgMjkgMTUuNCA4Mi40IDcuMiAyNC42LTMuOCAzMy44LTQuMiA2MC0zLjIgMTcgLjYgNDEuNCAzIDU0IDUuMiAzOC40IDYuNiA0OS42IDUuMiA3My0xMCA2LjYtNC4yIDE3LjQtOS40IDI0LTExLjYgNi42LTIuMiAxNi01LjggMjEtOC4yIDEzLTYgMjgtNS42IDM1LjYuOCAxMi40IDEwLjQgMTguNiA0MS40IDE0LjQgNzEuNi00LjQgMzAuNi0zIDM5LjQgOC40IDUzLjggMy40IDQuNCAxMS4yIDE5LjIgMTcuNCAzMy4yTDc3NSA0NDN2NzhsLTEwIDI4Yy0xNS4yIDQzLjItMzYuOCA3My4yLTY2LjIgOTIuOC0xMy40IDguOC01NyAyNS40LTc2LjggMjktMjguMiA1LjItMzMuMiAxMi42LTIyIDMyLjIgMTEuMiAxOS40IDEyLjQgMzIuOCAxMS42IDEyOS42bC0uNiA4NS44IDUuNCA0LjZjMy42IDMgOS4yIDUuMiAxNiA2IDUuOC44IDYwLjIgMSAxMjAuNi42IDEwOC40LS42IDExMC4yLS42IDExOS01IDI0LTExLjYgNDAtMjcuNCA1MS42LTUwLjZsNS40LTExIC42LTM0N2MuNC0yMjMtLjItMzUzLjQtMS40LTM2NS0yLTE3LTIuNi0xOC42LTEzLTM0LTEwLjYtMTUuNC0yMi44LTI2LjItNDMuMi0zNy4yLTQuMi0yLjQtNjQuNi0yLjgtMzY2LTMuMi0xOTguNiAwLTM2NCAuNC0zNjcuNiAxLjR6Ii8+PC9zdmc+);
    }
    
    
    
    
    
</style>

        
        <!-- Config CSS -->

<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-color: #F5F5F5;
      }

      /* blog_info bottom background */
      #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
        background-color: #fff;
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


<!-- Import Font -->

    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons"rel="stylesheet">


        <script>lsloader.load("js/jquery.min.js","/js/jquery.min.js?qcusAULNeBksqffqUM2+Ig==")</script>
    
    
    <script>function Queue(){this.dataStore=[];this.offer=b;this.poll=d;this.execNext=a;this.debug=false;this.startDebug=c;function b(e){if(this.debug){console.log("Offered a Queued Function.")}if(typeof e==="function"){this.dataStore.push(e)}else{console.log("You must offer a function.")}}function d(){if(this.debug){console.log("Polled a Queued Function.")}return this.dataStore.shift()}function a(){var e=this.poll();if(e!==undefined){if(this.debug){console.log("Run a Queued Function.")}e()}}function c(){this.debug=true}}var queue=new Queue();</script>

    <!-- Analytics -->
    

    <!-- Custom Head -->
    
</head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->

    <!-- Left aligned menu below button -->
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    
    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#基本属性"><span class="post-toc-number">1.</span> <span class="post-toc-text">基本属性</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Id-and-GeneratedValue"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">@Id and @GeneratedValue</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Column"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">@Column</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Basic和-Transient"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">@Basic和@Transient</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Temporal"><span class="post-toc-number">1.4.</span> <span class="post-toc-text">@Temporal</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Lob"><span class="post-toc-number">1.5.</span> <span class="post-toc-text">@Lob</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#FetchType（加载类型）"><span class="post-toc-number">2.</span> <span class="post-toc-text">FetchType（加载类型）</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#FetchType-LAZY"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">FetchType.LAZY</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#实体类关系"><span class="post-toc-number">3.</span> <span class="post-toc-text">实体类关系</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#OneToOne-一对一"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">OneToOne(一对一)</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#JoinColumn"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">@JoinColumn</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#双向-OneToOne关联"><span class="post-toc-number">3.2.1.</span> <span class="post-toc-text">双向@OneToOne关联</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#OneToMany-ManyToOne"><span class="post-toc-number">3.3.</span> <span class="post-toc-text">@OneToMany,@ManyToOne</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#ManyToMany"><span class="post-toc-number">3.4.</span> <span class="post-toc-text">@ManyToMany</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#JoinTable"><span class="post-toc-number">3.4.1.</span> <span class="post-toc-text">@JoinTable</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#用-ManyToOne实现多对多"><span class="post-toc-number">3.4.2.</span> <span class="post-toc-text">用@ManyToOne实现多对多</span></a></li></ol></li></ol></li></ol>
        <!--
        <li class="mdl-menu__item">
            Some Action
        </li>
        -->
    </ul>
    





<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script type="text/ls-javascript" id="post-thumbnail-script">
    var randomNum = Math.floor(Math.random() * 19 + 1);

    $('.post_thumbnail-random').attr('data-original', '/img/random/material-' + randomNum + '.png');
    $('.post_thumbnail-random').addClass('lazy');
</script>

        
    
            <p class="article-headline-p">
                Spring-data JPA 注解详解
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/avatar.jpg" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>sourfeng</strong>
        <span>5月 08, 2017</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/spring-data-jpa/">spring-data-jpa</a>
    </ul>
    

    <!-- Share -->
    <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=Spring-data JPA 注解详解&url=http://sourfeng.cn/2017/05/08/spring-data-jpa/index.html&pic=&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    

    <!-- Share Facebook -->
    

    <!-- Share Google+ -->
    
        <a class="post_share-link" href="https://plus.google.com/share?url=http://sourfeng.cn/2017/05/08/spring-data-jpa/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Google+
            </li>
        </a>
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    
        <a class="post_share-link" href="http://connect.qq.com/widget/shareqq/index.html?site=木子 oto&title=Spring-data JPA 注解详解&summary=Time goes by so fast, people go in and out of your life. You must never miss the opportunity to tell these people how much they mean to you.&pics=http://sourfeng.cn/img/favicon.png&url=http://sourfeng.cn/2017/05/08/spring-data-jpa/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 QQ
            </li>
        </a>
    

    <!-- Share Telegram -->
    
</ul>

</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <h1 id="基本属性"><a href="#基本属性" class="headerlink" title="基本属性"></a>基本属性</h1><h2 id="Id-and-GeneratedValue"><a href="#Id-and-GeneratedValue" class="headerlink" title="@Id and @GeneratedValue"></a>@Id and @GeneratedValue</h2><p><code>@Id</code> 标注应用于实体类的属性或者属性对应的<code>getter</code>方法，表示该属性映射为数据库表的主键。     </p>
<p><code>@GeneratedValue</code>与<code>@Id</code>一同使用，表示主键的生成策略，通过strategy属性指定。<br>在<code>javax.persistence.GenerationType</code>定义了如下几种策略：</p>
<ul>
<li><code>IDENTITY</code>：采用数据库<code>ID</code>自增长的方式产生主键，<code>Oracle</code>不支持这种方式。     </li>
<li><code>AUTO</code>： JPA自动选择合适的策略，是默认选项。     </li>
<li><code>SEQUENCE</code>：通过序列产生主键，通过<code>@SequenceGenerator</code>标注指定序列名，MySQL不支持这种方式。   </li>
<li><p><code>TABLE</code>：通过表产生主键，框架借由表模拟序列产生主键，使用该策略更易于做数据库移植。     </p>
<h2 id="Column"><a href="#Column" class="headerlink" title="@Column"></a>@Column</h2><p>@Column注解来标识实体类中属性与数据表中字段的对应关系，一共10个属性，并且这10个属性均是可选属性。详细内容如下：    </p>
</li>
<li><p><code>name</code>：表示数据库表中该字段的名称，默认情形属性名称一致。       </p>
</li>
<li><code>nullable</code>：表示该字段是否允许为<code>null</code>，默认为<code>true</code>。      </li>
<li><code>unique</code>：表示该字段是否是唯一标识，默认为<code>false</code>。         </li>
<li><code>length</code>：表示该字段的大小，仅对<code>String</code>类型的字段有效。      </li>
<li><code>insertable</code>：表示在<code>ORM</code>框架执行插入操作时，该字段是否应出现<code>INSETRT</code>语句中，默认为<code>true</code>。        </li>
<li><code>updateable</code>：表示在ORM框架执行更新操作时，该字段是否应该出现在<code>UPDATE</code>语句中，默认为<code>true</code>。对于一经创建就不能更改的字段，该属性非常有用，比如<code>email</code>属性。               </li>
<li><code>columnDefinition</code>：表示该字段在数据库中的实际类型。通常ORM框架可以根据属性类型自动判断数据库中字段的类型，但是依然有些例外：<br>  ①<code>Date</code>类型无法确定数据库中字段类型究竟是<code>DATE</code>、<code>TIME</code>还是<code>TIMESTAMP</code><br>  ②<code>String</code>的默认映射类型为<code>VARCHAR</code>，如果希望将<code>String</code>类型映射到特定数据库的<code>BLOB</code>或<code>TEXT</code>字段类型，则需要进行设置</li>
<li><code>table</code>：表示包含当前字段的表名，很少使用      </li>
<li><code>precision</code>和<code>scale</code>：表示精度，当字段类型为<code>double</code>时，<code>precision</code>表示数值的总长度，<code>scale</code>表示小数所占位数。</li>
</ul>
<p>由于上面的<code>insertable</code>和<code>updateable</code>是一样的性质，这里只是对<code>insertable</code>做说明，<br>当以这种方式向数据库插入数据时(000003000002,lili,产品,23)：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Id</span></span><br><span class="line"><span class="keyword">private</span> String id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> String name;</span><br><span class="line"><span class="keyword">private</span> String intro;</span><br><span class="line"><span class="meta">@Column</span>(insertable = <span class="keyword">false</span>)</span><br><span class="line"><span class="keyword">private</span> String age;</span><br></pre></td></tr></table></figure>
<p>当查询数据库时，显示的确是这样：        </p>
<table>
<thead>
<tr>
<th>id</th>
<th>age</th>
<th>intro</th>
<th>name</th>
<th>businesses_id</th>
</tr>
</thead>
<tbody>
<tr>
<td>000003000002</td>
<td>null</td>
<td>产品</td>
<td>lili</td>
<td>000003</td>
</tr>
</tbody>
</table>
<p>正如上面看到的那样，如果添加了<code>@Column(insertable = false)</code>,那么在插入数据的时候，将不会被写入数据库</p>
<h2 id="Basic和-Transient"><a href="#Basic和-Transient" class="headerlink" title="@Basic和@Transient"></a>@Basic和@Transient</h2><p><code>@Basic</code>表示属性到数据库表的字段的映射。<br><code>@Basic</code>有两个常用属性：      </p>
<ul>
<li><code>fetch</code>: 表示实体类对应属性的读取策略，有<code>EAGER</code>和<code>LAZY</code>两种取值，分别表示主动抓取和延迟加载，默认值为<code>EAGER</code>。        </li>
<li><code>optional</code>:表示该属性是否允许为<code>null</code>，默认值为<code>true</code>。</li>
</ul>
<p><code>@Transient</code>表示该属性并非一个到数据库表的字段的映射，JPA将忽略该属性。<br>如果一个属性并非数据库表的字段映射，就务必将其标注为<code>@Transient</code>，否则JPA默认其注解为<code>@Basic</code>。</p>
<h2 id="Temporal"><a href="#Temporal" class="headerlink" title="@Temporal"></a>@Temporal</h2><p>在数据库中，表示时间类型的数据有 <code>DATE</code>，<code>TIME</code>，和 <code>TIMESTAMP</code> 三种精度 ( 即单纯的日期，时间，或者两者兼备 )。 可使用<code>@Temporal</code>来设置<code>Date</code>类型的属性映射到对应精度的字段。</p>
<ul>
<li><code>@Temporal(TemporalType.DATE)</code>映射为日期 // date （只有日期）      </li>
<li><code>@Temporal(TemporalType.TIME)</code>映射为日期 // time （是有时间）      </li>
<li><code>@Temporal(TemporalType.TIMESTAMP)</code>映射为日期 // date time （日期+时间）</li>
</ul>
<h2 id="Lob"><a href="#Lob" class="headerlink" title="@Lob"></a>@Lob</h2><p><code>@Lob</code>标注表示将属性映射成数据库支持的大对象类型，<code>Clob</code>或者<code>Blog</code>。其中：</p>
<ul>
<li><code>Clob（Character Large Ojects）</code>类型是长字符串类型，<code>java.sql.Clob</code>、<code>Character[]</code>、<code>char[]</code> 和 <code>String</code> 将被映射为 <code>Clob</code> 类型。     </li>
<li><code>Blob（Binary Large Objects）</code>类型是字节类型，<code>java.sql.Blob</code>、<code>Byte[]</code>、<code>byte[]</code> 和 实现了<code>Serializable</code>接口的类型将被映射为<code>Blob</code> 类型。</li>
</ul>
<p>因为这两种类型的数据一般占用的内存空间比较大，所以通常使用延迟加载的方式，与<code>@Basic</code>标注同时使用，设置加载方式为<code>FetchType.LAZY</code>。</p>
<h1 id="FetchType（加载类型）"><a href="#FetchType（加载类型）" class="headerlink" title="FetchType（加载类型）"></a>FetchType（加载类型）</h1><p>##FetchType.EAGER<br>饥饿加载，查询实体A时，会查询关联表B。加载默认使用的就是这种方式，但是需要注意的一点就是，使用这种加载方式，需要有<code>get()</code>方法才能返回正常的数据，换句话说，如果我们想控制不加载某个属性，只需要去掉<code>get()</code>方法就可以了。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//public void setLottery(B b) &#123;</span></span><br><span class="line"><span class="comment">//       this.b = b;</span></span><br><span class="line"><span class="comment">//   &#125;</span></span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> B <span class="title">getLottery</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       <span class="keyword">return</span> b;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<h2 id="FetchType-LAZY"><a href="#FetchType-LAZY" class="headerlink" title="FetchType.LAZY"></a>FetchType.LAZY</h2><p>延迟加载，一般用于关联表的查询，查询A实体时，不查询关联B实体。如果写入<code>get()</code>方法，并使用<code>FetchType.LAZY</code>,那么会抛出<code>org.springframework.http.converter.HttpMessageNotWritableException</code>异常，这是由于使用<code>FetchType.LAZY</code>方式时，<code>get()</code>方法返回的并不是一个常规的对象，而是一个<code>JavassistLazyInitializer</code>，从而不能写入JSON文档，那么解决办法就是忽略json，所以需要添加一个<code>@JsonIgnore</code>的注解。当然，如果不写注解，只需要去掉<code>get()</code>方法，也不会这个问题。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">@Entity</span><br><span class="line">public class A implements Serializable&#123;</span><br><span class="line">    @Id</span><br><span class="line">    @Column(unique = true,nullable = false,length = 20)</span><br><span class="line">    private String id;   //奖品id(奖品编号)</span><br><span class="line">    @Column(nullable = false,length = 40)</span><br><span class="line">    private String name; //奖品名称</span><br><span class="line">    @Column(nullable = false,length = 20)</span><br><span class="line">    private String num;  //奖品数量</span><br><span class="line"></span><br><span class="line">    @ManyToOne(fetch = FetchType.LAZY)</span><br><span class="line">    @JsonIgnore</span><br><span class="line">    private B b;</span><br><span class="line"></span><br><span class="line">    //忽略部分get，set方法</span><br><span class="line"></span><br><span class="line">    public void setLottery(B b) &#123;</span><br><span class="line">        this.b = b;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public B getLottery() &#123;</span><br><span class="line">        return b;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h1 id="实体类关系"><a href="#实体类关系" class="headerlink" title="实体类关系"></a>实体类关系</h1><p>JPA<code>@OneToOne</code>、<code>@ManyToOne</code>、<code>OneToMany</code>和<code>@ManyToMany</code>几个标注提供用以定义实体类之间的关系。</p>
<h2 id="OneToOne-一对一"><a href="#OneToOne-一对一" class="headerlink" title="OneToOne(一对一)"></a>OneToOne(一对一)</h2><p>一对一的属性：</p>
<ul>
<li><code>targetEntity</code>属性表示默认关联的实体类型，默认为当前标注的实体类，绝大数据情况下不需要进行设置。</li>
<li><code>cascade</code>属性表示级联操作策略：<ol>
<li>不定义,则对关系表不会产生任何影响</li>
<li><code>CascadeType.PERSIST</code>:级联新建</li>
<li><code>CascadeType.REMOVE</code>:级联删除</li>
<li><code>CascadeType.REFRESH</code>: 级联刷新，即重新同步到数据库中状态，会覆盖掉已经修改但是还没保存的实体类属性</li>
<li><code>CascadeType.MERGE</code>: 级联更新</li>
<li><code>CascadeType.ALL</code>:表示选择全部四项</li>
</ol>
</li>
<li><code>fetch</code>属性表示实体的加载方式，有<code>LAZY</code>和<code>EAGER</code>两种取值，默认值为<code>EAGER</code>    </li>
<li><code>optional</code>属性表示关联的实体是否能够存在<code>null</code>值，默认为<code>true</code>，表示可以存在<code>null</code>值<br>关于<code>fetch</code>属性，所有<code>@XXXToOne</code>，默认值为<code>EAGER</code>，所有<code>@XXXToMany</code>，默认值为<code>LAZY</code>。</li>
</ul>
<h2 id="JoinColumn"><a href="#JoinColumn" class="headerlink" title="@JoinColumn"></a>@JoinColumn</h2><p>如果使用了<code>@OnetoOne</code>标注，对于表中的字段，会自动映射生成字段名，并且按照如下方式：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">关联表的名称 + &quot;_&quot; + 关联表主键的字段名</span><br></pre></td></tr></table></figure></p>
<p>比如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@Id</span><br><span class="line">private String id;</span><br><span class="line"></span><br><span class="line">private String name;</span><br><span class="line">private String intro;</span><br><span class="line">private String age;</span><br><span class="line"></span><br><span class="line">@OneToOne</span><br><span class="line">private B b;</span><br></pre></td></tr></table></figure>
<p>那么<code>User</code>表中的自定生成的字段名就为：<code>b_id</code></p>
<p>如果对应的字段名是其他名字，则可以通过@JoinColumn来定义外键关联的字段名称。比如如果字段名为blog_Id的话，可以这样定义：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@Id</span><br><span class="line">private String id;</span><br><span class="line"></span><br><span class="line">private String name;</span><br><span class="line">private String intro;</span><br><span class="line">private String age;</span><br><span class="line"></span><br><span class="line">@OneToOne(name = &quot;blog_Id&quot;)</span><br><span class="line">private B b;</span><br></pre></td></tr></table></figure>
<h3 id="双向-OneToOne关联"><a href="#双向-OneToOne关联" class="headerlink" title="双向@OneToOne关联"></a>双向@OneToOne关联</h3><p>如果能从A实体种直接引用到B，则可以为A增加一个类型为B的属性，这样两个实体类就是一种双向关联关系了。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public class A&#123;</span><br><span class="line">    @Id</span><br><span class="line">    private String id;</span><br><span class="line"></span><br><span class="line">    private String name;</span><br><span class="line">    private String intro;</span><br><span class="line">    private String age;</span><br><span class="line"></span><br><span class="line">    @OneToOne(mappedBy = &quot;a&quot;)</span><br><span class="line">    private B b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>注意上面的代码中，不仅用<code>@OneToOne</code>标注了b，同时还设置<code>mappedBy</code>属性。<br>关于mappedBy属性，需要理解一下两点：</p>
<ul>
<li><code>mappedBy</code> = “a”表示，当前类（A）是通过B中a属性与之建立关联的。</li>
<li><p>设置了<code>mappedBy</code>属性的关系标注（各种<code>@XXXToXX</code>），表明当前类是关系的被维护方，而另外一个类则是关系维护方，你可以这样理解： </p>
<ol>
<li>关系维护方（B类）对应的是定义外键约束的数据库表     </li>
<li>关系被维护方（A类）对应于外键所在的数据库表       </li>
</ol>
</li>
</ul>
<p>最后需要注意的一个问题是，关系维护方才能够操作两者的关系。反过来说，A对象即使设置B属性，如果对该对象进行存储，并不会去更新外键关联，因为A是关系<strong>被维护方</strong>。</p>
<h2 id="OneToMany-ManyToOne"><a href="#OneToMany-ManyToOne" class="headerlink" title="@OneToMany,@ManyToOne"></a>@OneToMany,@ManyToOne</h2><p>如果在B中也定义一个C类型的成员变量，则两者形成了双向关系，<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@Entity</span><br><span class="line">class C &#123;</span><br><span class="line">    @ManyToOne</span><br><span class="line">    private B b;</span><br><span class="line">   </span><br><span class="line">    // ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@Entity</span><br><span class="line">class B &#123;</span><br><span class="line">    @OneToMany(mappedBy = &quot;b&quot;)</span><br><span class="line">    private List&lt;C&gt; cs;</span><br><span class="line">    </span><br><span class="line">    // ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>@OneToMany</code>标注的实体类属性（或者其<code>getter</code>）类型为集合类型，<code>fetch</code>那么默认为<code>LAZY</code>。</p>
<p><code>mappedBy = &quot;b&quot;</code>表示，当前类（B）是通过C中b属性与之建立关联的。记住只要是使用了<code>mappedBy</code>，就是关系被维护方。</p>
<h2 id="ManyToMany"><a href="#ManyToMany" class="headerlink" title="@ManyToMany"></a>@ManyToMany</h2><p>一篇博客可以有多个标签，而一个标签可以使用在多篇博客上，<code>Blog</code>类和<code>Tag</code>类是典型的多对多关系。    </p>
<p><code>@ManyToMany</code>用以表示多对多关系，与<code>@OneToOne</code>和<code>@ManyToOne</code>一样，也可以有单向和双向关系之分。     </p>
<p>是单向还是双向，和标注本身并没有关系，只是看实体类之间是否相互引用。<br>下面的代码定义了<code>Blog</code>到<code>Tag</code>的单向多对多关系，所有操作都设置为级联的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@Entity</span><br><span class="line">public class Blog &#123;</span><br><span class="line">    @ManyToMany(cascade = CascadeType.ALL)</span><br><span class="line">    private List&lt;Tag&gt; tags = new ArrayList&lt;Tag&gt;();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@Entity</span><br><span class="line">public class Tag &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果在<code>Tag</code>中定义一个<code>Blog</code>集合，则形成双向关系：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@Entity</span><br><span class="line">public class Tag &#123;</span><br><span class="line">    @ManyToMany(mappedBy = “tags”)</span><br><span class="line">    private List&lt;Blog&gt; blogs = new ArrayList&lt;Blog&gt;();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>mappedBy = &quot;tag&quot;</code>表示，当前类（<code>Tag</code>）是通过<code>Blog</code>中<code>tags</code>属性与之建立关联的。<code>Blog</code>是关系维护方，<code>Tag</code>类是关系被维护方。</p>
<h3 id="JoinTable"><a href="#JoinTable" class="headerlink" title="@JoinTable"></a>@JoinTable</h3><p>多对多关系的定义如果自动生成<code>DDL</code>，则会生成一张描述多对多关系的表，在这个例子中表明为<code>blog_tag</code>，表中的两个属性分别会命名为<code>blog_id</code>和<code>tag_id</code>。</p>
<p>如果需要指定表名和属性名，即基于自动映射的命名规则生成的Schema相关命名，和实际命名不相同时，则需要使用<code>@JoinTable</code>标注，如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">@Entity</span><br><span class="line">public class Blog &#123;</span><br><span class="line">    @ManyToMany(cascade = CascadeType.ALL)</span><br><span class="line">    @JoinTable(</span><br><span class="line">        name=&quot;blog_tag_relation&quot;,</span><br><span class="line">        joinColumns=@JoinColumn(name=&quot;blog_id&quot;, referencedColumnName=&quot;id&quot;),</span><br><span class="line">        inverseJoinColumns=@JoinColumn(name=&quot;tag_id&quot;, referencedColumnName=&quot;id&quot;)</span><br><span class="line">    )</span><br><span class="line">    private List&lt;Tag&gt; tags = new ArrayList&lt;Tag&gt;();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="用-ManyToOne实现多对多"><a href="#用-ManyToOne实现多对多" class="headerlink" title="用@ManyToOne实现多对多"></a>用@ManyToOne实现多对多</h3><p>在实际情况下，我们建立多对多关系的同时还需要存储一些其他信息，例如该关系的创建时间，此时，我们可以将多对多关系分解为两个多对一关系。</p>
<p>定义一个<code>BlogTag</code>实体类来表示<code>Blog</code>与<code>Tag</code>之间的多对多关系：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">@Entity</span><br><span class="line">class BlogTag &#123;</span><br><span class="line">    @ManyToOne</span><br><span class="line">    private Blog blog;</span><br><span class="line"></span><br><span class="line">    @ManyToOne</span><br><span class="line">    private Tag tag;</span><br><span class="line"></span><br><span class="line">    private Date createdTime;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>让<code>BlogTag</code>这个实体类建立与<code>Blog</code>和<code>Tag</code>的多对一关系：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@Entity</span><br><span class="line">public class Blog &#123;</span><br><span class="line">    @OneToMany(mappedBy = &quot;blog&quot;)</span><br><span class="line">    private final List&lt;BlogTag&gt; blogTags = new ArrayList&lt;BlogTag&gt;();</span><br><span class="line"></span><br><span class="line">    public List&lt;Tag&gt; getTags() &#123;</span><br><span class="line">        return blogTags.stream().map(BlogTag::getTag).collect(Collectors.toList());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@Entity</span><br><span class="line">public class Tag &#123;</span><br><span class="line">    @OneToMany(mappedBy = &quot;tag&quot;)</span><br><span class="line">    private final List&lt;BlogTag&gt; blogTags = new ArrayList&lt;BlogTag&gt;();</span><br><span class="line"></span><br><span class="line">    public List&lt;Blog&gt; getBlogs() &#123;</span><br><span class="line">        return blogTags.stream().map(BlogTag::getBlog).collect(Collectors.toList());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

    

    
</div>


                

                <!-- Post Comments -->
                
                    
                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2017/03/27/android annotation/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/avatar.jpg" alt="sourfeng's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        sourfeng@163.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="sourfeng@163.com" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2017/05/">五月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/03/">三月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/01/">一月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/07/">七月 2016<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/05/">五月 2016<span class="sidebar_archives-count">1</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">chrome_reader_mode</i>
                
                分类
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
                <li>
                <a class="sidebar_archives-link" href="/categories/git/">git<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/spring-boot/">spring boot<span class="sidebar_archives-count">1</span></a>
            </ul>
        </li>
        
    

    <!-- Pages  -->
    

    <!-- Article Number  -->
    
        <li>
            <a href="/archives">
                文章总数
                <span class="sidebar-badge">6</span>
            </a>
        </li>
        
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->

    <div class="sidebar-divider"></div>


<!-- Theme Material -->

    <a href="https://github.com/viosey/hexo-theme-material"  class="sidebar-footer-text-a" target="_blank">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
            主题 - Material
            <span class="sidebar-badge badge-circle">i</span>
        </div>
    </a>


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div id="back-to-top" class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    

    <!-- Facebook -->
    

    <!-- Google + -->
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    
        <a href="https://github.com/sourfeng" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-github">
                <span class="visuallyhidden">Github</span>
            </button><!--
     --></a>
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©<script type="text/javascript">var fd = new Date();document.write("&nbsp;" + fd.getFullYear() + "&nbsp;");</script>木子 oto
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import File -->


    <script>lsloader.load("js/lazyload.min.js","/js/lazyload.min.js?1BcfzuNXqV+ntF6gq+5X3Q==")</script>
    <script>lsloader.load("js/js.min.js","/js/js.min.js?oAl/+lvaqTFV31JXTmbrNA==")</script>



    <script>lsloader.load("js/nprogress.js","/js/nprogress.js?pl3Qhb9lvqR1FlyLUna1Yw==")</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>













<!-- UC Browser Compatible -->
<script>
	var agent = navigator.userAgent.toLowerCase();
	if(agent.indexOf('ucbrowser')>0) {
		document.write('<link rel="stylesheet" href="/css/uc.css">');
	   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
	}
</script>

<!-- Window Load-->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });
</script>

<!-- MathJax Load-->

<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Bing Background -->


<script>
    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
console.log('\n %c © Material Theme | Version: 1.4.0 | https://github.com/viosey/hexo-theme-material %c \n', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;');
</script>

                </main>
            </div>
        </body>
    
</html>
